### MCR: runc process.cwd and leaked fds container breakout 
#### Release Date
2024-01-31
#### Overview
Several container breakouts due to internally leaked fds.

Consult the [upstream advisory][upstream] and [snyk][snyk.io] for details, mitigations, workarounds, and patches.
#### Affected Products
Mirantis Container Runtime (MCR) <= 23.0.9
### Vulnerability Information
#### CVE Identifier
[CVE-2024-21626][nvd.nist.gov]
#### CVSSv3.1
8.6 (High) CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
#### CWEs
CWE-403, CWE-668
#### How to check if your environment is vulnerable
* `containerd.io` package version is equal or lower (<=) than:
  - 1.6.28~rc.1-1 for DEB package based OSes
  - 1.6.28-2.1.rc.1.1 for RPM package based OSes
#### How to fix
Upgrade MCR packages to the fixed 23.0.9 version or newer
* `docker-ee*` packages to:
  - 23.0.9~4-0 for DEB package based OSes
  - 23.0.9-4 for RPM package based OSes
* `containerd.io` package to
  - 1.6.28~rc.1-2 for DEB package based OSes
  - 1.6.28-4.1.rc.1.1 for RPM package based OSes
Please follow the [MCR official installation documentation][mcr.docs]
#### Acknowledgements
Found by Rory McNamara at Snyk 
#### Disclosure Timeline
* 2023-11-20: Rory McNamara initially discovered the vulnerabilities. He began the internal verification process and additional research to validate findings and build POC exploits.
* 2023-12-11: Initial disclosure sent to Docker with all vulnerabilities, and Docker ACKed the same day.
* 2023-12-12: Snyk received a request from Docker to forward the WORKDIR vulnerability to runc, as it was deemed their responsibility.
* 2023-12-13: Rory was added as a Github Security Advisory (GHSA) collaborator for the Arbitrary Delete and grpc Docker/Buildkit vulns (both initially opened 11-Dec-2023).
* 2023-12-19: Rory was added as GHSA collaborator to WORKDIR by runc (initially opened 11-Dec-2023).
* 2023-12-20: Rory was added as GHSA collaborator for the cache race vulnerability.
* 2024-01-02: runc CVE assigned (Github CNA).
* 2024-01-17: runc sends an announcement to their security mailing list including the patches & embargo date of 31-Jan-2024.
* 2024-01-24: Docker vulnerabilities CVEs assigned (GitHub CNA).
* 2024-01-31: All four "Leaky Vessels" vulnerabilities announced publicly.
* 2024-01-31: Runc released version 1.1.12 which fixes the vulnerabilities.
* 2024-02-08: MCR 23.0.9-1 released

  [upstream]: https://github.com/opencontainers/runc/security/advisories/GHSA-xr7r-f8xq-vfvv
  [snyk.io]: https://snyk.io/blog/cve-2024-21626-runc-process-cwd-container-breakout 
  [nvd.nist.gov]: https://nvd.nist.gov/vuln/detail/CVE-2024-21626 
  [mcr.docs]: https://docs.mirantis.com/mcr/23.0/install/mcr-linux.html